# 2026-01-15  weekly meeting progress

## 修正概要:
- 仕様変更: PDF変換をダウンロード時ではなく解答生成後に実行、ZIPではなくPDFでダウンロード、year表記を年度に統一
- サーバー側の受け取り制限: PDF形式/20MB/年数値/100文字制限などの入力チェックを追加
- フロント側のUI/UX向上: 通知トースト化、入力制限・カウンタ、カード/ボタンの改善
- ジョブ検索機能の追加: job_id入力でステータス取得・一覧に追加
- 「もう一度試す」提案導線: 失敗・停滞時の再送信モーダル

## 具体的な変更点:
- FastAPI `/api/v1/pipeline/{job_id}/download` をZIP返却からPDF返却に変更
- ダウンロードPDFのファイル名を `explanation_name.pdf` に統一
- `data/outputs/{job_id}/` へPDFをキャッシュ保存（`explanation_name` 由来）
- ファイル名のサニタイズを強化（禁止文字置換・末尾空白/ドット除去）
- Markdown複数時は更新日時が最新の1件のみPDF化
- PDF変換をダウンロード時ではなくパイプライン内で実行
- `generating_pdf` ステータスを追加し、UI/ドキュメントに反映
- `failed_to_convert` を「生成時のPDF変換失敗」に定義変更
- PDF保持は「永久保存」に変更
- Basic認証の既定値は `BASIC_AUTH_USER/PASSWORD=dev` と整理
- `api_key` は `multipart/form-data` 優先の方針を維持
- 生成APIの入力検証を追加（サーバ側）
- `input_file` の拡張子 `.pdf` / `content_type` / 20MB制限を実装
- `year` は1〜4桁の数字のみ許可
- `explanation_name` / `university` / `subject` / `author` は100文字制限
- サーバ側の入力エラーは `422` + フィールド別 `detail` で返す
- `year` 表記を「年度」付きに統一（フロント自動生成＋脚注）
- フロントは `useToast()` に通知を統一
- サーバのフィールドエラーをトースト本文に含めて表示
- ジョブ一覧のポーリング間隔を10秒に変更
- 更新ボタンは押下後10秒間ローディング＆無効化
- ジョブ一覧に残り時間の目安表示を追加
- 目安ラベルをステータスBadgeの直後に配置
- `accepted` を待機ステータスに追加
- ジョブ一覧に「更新する」ボタンを追加
- ステータス更新は待機ジョブのみ対象
- `done` のみダウンロードボタン表示に変更
- 409時は `failed_to_convert` に更新し再試行導線を表示
- 「もう一度試す」モーダルを追加（再入力支援）
- 30分以上 `generating_md` のジョブに再試行ボタン表示
- もう一度試す時も `localStorage` のフォーム値を活用
- 入力フォーム値（year/subject/university/author/explanation_name）を `localStorage` に保存
- ジョブ追加（検索）機能を追加（job_id入力 → status取得成功で追加）
- 存在しない `job_id` は追加せずトースト表示
- 依頼後の案内モーダルを追加（待ち時間・退出可・失敗可能性など）
- job_id のコピー機能とコピー通知を追加
- 案内モーダル上部にチェックアイコンのアニメーション追加
- APIキー入力をパスワード表示に変更
- ファイルアップロードUIをカード型に変更（クリック範囲100%）
- ファイルアップロードのデザインを安定化（白背景＋ホバー/フォーカス）
- ファイルサイズ（20MB）をフロントで事前チェック
- `year` 入力を数値のみ・最大4桁に制限（inputMode/pattern）
- 文字数カウンタを表示（100文字上限）
- ステータスラベル/バッジの文言を整理（PDF生成中など）
- ダウンロード時のファイル名 `.pdf` 強制補正
- アイコンを各ボタンに付与（リクエスト/更新/コピー/ダウンロード）
- 見出し左に Edit アイコンを配置
- TIPS のスライド表示を廃止し補足文に一本化
- AGENTS.md / AGENTS_for_React.md を最新仕様に更新
